'''123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    Generate vina score for every ligand-pdb target123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF'''123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFfrom vector_gen import pdb_container123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFfrom Config import *123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFimport os,csv123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFFILE_NAME = 'score_onlyinbox.csv'123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFdef score_one_by_vina(PDBname, CLEAN=False):123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    '''123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    Record score of possible pair123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    :param PDBname: the name of pdb123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    :return: nothing but will generate rows in FILE_NAME123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    '''123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    if CLEAN:123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF        files = os.listdir('data/')123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF        for filename in files:123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF            loc = os.path.join('data/') + filename123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF            if os.path.exists(loc):123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF                os.remove(loc)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    source_pdb_loc = os.path.join(pdb_PREFIX,PDBname+'.pdb.gz')123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    pdb = pdb_container(PDBname,filepos=source_pdb_loc)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    pdb.set_all_vina_benchmark()123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    writer = file('result/{}'.format(FILE_NAME), 'a')123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    w = csv.writer(writer)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    for k,v in pdb.heterodict.items():123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF        one_line= [PDBname,k,v['ligand'].getResname(),v['vina_score']]123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF        w.writerow(one_line)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    writer.flush()123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    writer.close()123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFdef initiate_score_file():123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    writer = file('result/{}'.format(FILE_NAME), 'wb')123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    w = csv.writer(writer)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    w.writerow(['PDBname','Target Ligang ID', 'Target Ligand NAME', 'Vina Score(kcal/mol)'])123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFif __name__ == '__main__':123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    initiate_score_file()123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    for each in PDB_tar:123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF        each = each.lower()123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF        score_one_by_vina(each,CLEAN=True)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF