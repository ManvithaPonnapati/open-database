import os,sys123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFimport config123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFfrom util import log,mkdir123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFfrom glob import glob123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFimport multiprocessing123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFdef dock_ligand(ligand_path):123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    receptor_name = os.path.basename(ligand_path).split('_')[0]123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    receptor_path = os.path.join(config.splited_receptors_path, receptor_name + '.pdb')123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    docked_ligand_name = os.path.basename(ligand_path).replace('ligand','ligand_docked')123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    docked_ligand_path = os.path.join(config.docked_ligand_path, receptor_name, docked_ligand_name)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    if not os.path.exists(docked_ligand_path):123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF        cmd = '{} -r {} -l {} --autobox_ligand {} -o {} --num_modes=1000 --energy_range=100 --cpu=1 '\123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF            .format(config.smina,receptor_path,ligand_path,ligand_path,docked_ligand_path)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF        mkdir(os.path.dirname(docked_ligand_path))123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF        os.system(cmd)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFdef docking():123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    ligands_list = glob(config.splited_ligands_path)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    pool = multiprocessing.Pool(config.process_num)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    pool.map_async(dock_ligand,ligands_list)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    pool.join()123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    pool.close()