123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFimport os,sys123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFimport prody123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFimport tempfile123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF#import chembl123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFimport subprocess123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFdef mkpml(tdir, lig_path, rec_path):123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF	pml_path = os.path.join(tdir, 'script.pml')123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF	f_path = os.path.join(tdir,'around.fasta')123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF	with open('script.pml','w') as f:123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF		f.write('cmd.load("ligand.pdb")\n'.format(lig_path))123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF		f.write('cmd.load("receptor.pdb")\n'.format(rec_path))123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF		f.write('cmd.select("bbnear","receptor w. 10 of ligand")\n')123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF		f.write('cmd.select("res","br. bbnear")\n')123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF		f.write('cmd.save("around.fasta","res")\n'.format(f_path))123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF	123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF	123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF	return pml_path, f_path123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFdef parse_PDB(PDBname):123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF	tdir = tempfile.mkdtemp()123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF	os.chdir(tdir)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF	PDBHead = prody.parsePDBHeader(PDBname)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF	PDB = prody.parsePDB(PDBname)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF	ligands = []123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF	for chem in PDBHead['chemicals']:123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF		ligands.append([chem.chain, str(chem.resnum), chem.resname])123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF	for chain, resnum, resname in ligands:123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF		try:123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF			123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF			receptor = PDB.select('not (chain {} resnum {})'.format(chain, resnum))123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF			ligand = PDB.select('chain {} resnum {}'.format(chain, resnum))123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF			rec_path = os.path.join(tdir,'receptor.pdb')123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF			lig_path = os.path.join(tdir,'ligand.pdb')123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF			prody.writePDB('receptor.pdb', receptor)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF			prody.writePDB('ligand.pdb', ligand)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF			pml_path, f_path = mkpml(tdir, lig_path, rec_path)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF			cl = subprocess.Popen('pymol -qc script.pml', shell=True, stdout=subprocess.PIPE)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF			cl.wait()123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF			with open('around.fasta') as fin:123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF				fin.readline()123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF				sequence = fin.readline().strip()123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF			print("sequence")123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF			print(sequence)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF		except Exception as e:123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF			print (e)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFif __name__ == '__main__':123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF	parse_PDB('3eml')123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF