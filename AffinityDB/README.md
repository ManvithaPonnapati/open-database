# AffinityDB123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFThis module is used to prepare data and collect information for them.123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF## requirement123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- openbabel123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF    123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF## usage123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF### Setting parameters in config.py123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- **database_root** : the folder to store everyting generated by this module.123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- **smina** : the path for smina executable file123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF### database create option123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF```bash123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFpython database_create.py --[option]123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF```123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF**Option:**123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- download123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- split123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- rotbond123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- similarity123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- vinardo_dock123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- smina_dock123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- cleanempty123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- rmsd123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- overlap123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- native_contact123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- addh123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- minimize123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF#### download123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFEach pdb structure in [Protein Data Bank](http://www.rcsb.org/pdb/home/home.do) has an unique id with 4 letter or number like [3EML](http://www.rcsb.org/pdb/explore/explore.do?structureId=3eml). This option get the id of the pdb structure from `config.list_of_PDB_to_download`, and download pdb file to `config.pdb_download_path`.123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF#### split123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFThe pdb file downloaded from Protein DataBank is co-crystal strucute with proteins, nucleics, residues, water and single meal atoms inside. This option select the receptors and ligands from it, and store them to `config.splited_receptors_path` and `config.splited_ligand_path`.123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFReceptors here means `protein or nucleic`123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFLigands here means `(hetero and not water) or resname ATP or resname ADP or resname AMP or resname GTP or resname GDP or resname GMP`123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFSplited receptors named by `[pdbid]` e.g. `3eml.pdb`123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFSplited ligands named by `[pdbid]_[residue_name]_[residue_id]_ligand` e.g. `3eml_SO4_123_ligand.pdb` 123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF#### rotbond 123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF**Require Openbabel Python binding**123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFCount the number of rotable bonds for the ligands. 123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF#### similarity123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFThe finger print encode molecular structure into binary bits string. We take the similarity between the binary string as the similarity between two ligands.  123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFThis option use OpenBabel to calculate similarity between the ligands splited from same pdb file. 123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFAvailable finger print types: 123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- FP2123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- FP3123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- FP4123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF- MACCS 123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF```bash123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFbabel -d ligand-a.pdb ligand-b.pdb -ofpt -xfFP2123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF```123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF[Tutorial:Fingerprints](https://openbabel.org/wiki/Tutorial:Fingerprints)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF#### vinardo_dock123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFDocking ligands back to their binding pocket by smina, the scoring function is **[vinardo](http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0155183)**123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF#### smina_dock123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFDocking ligands back to their binding pocket by smina, the scoring function is the default scoring function for smina.123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF#### cleanempty123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFCheck if the docking result is empty and if the docking result can be parsed by prody.123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFRemove failed docking result.123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF#### rmsd123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFCalculate the [RMSD](https://www.wikiwand.com/en/Root-mean-square_deviation_of_atomic_positions) for docking result with the ligands splited from the same pdb and have same residue name. 123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF#### overlap123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFCalculate the overlap ratio for docking result among the ligands splited from the same pdb.123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFOverlap ratio measure how close the _ligand-a_ to the _ligand-b_:123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF - _A_ is an atom of the _ligand-a_, if exists atom _B_ of the _ligand-b_ where distance(A,B) <  `config.clash_cufoff_A`, we call A _ovalap atom_123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF - overlap ratio of _ligand-a_ = number(overlap atoms of _ligand-a_ ) / number(all atoms of _ligand-a_)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF#### native_contact123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFCalculate native contact ratio for the docking result with the splited ligand.123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFWhen docking the splited ligand back to its binding pocket, most time the result will not be docked to exactly the same place.123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFnative contact ratio is an measure about how close the docked result _conf-a_ to the splited ligand _conf-ori_ ( _conf-a_ and _conf-ori_ are different comformation of the same molecule, they have same atoms but different coordinate)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF - _c(A)_  is the coordinate of atom _A_ in _conf-a_, _c'(A)_ is the coordinate of atom _A_ in _conf-ori_, _c''(P)_ is the coordinate of atom _P_ in receptor .123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF  - native contact ratio with cutoff _D_ = number( distance(_c'(A)_,_c''(P)_) < _D_ and distance(_c(A)_,_c''(P)_) < _D_) / number( distance(_c(A)_,_c''(P)_) < _D_ )123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF#### addh123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFMake all hydrogen explicit123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF```bash123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFobabel -ipdb input_file -opdb output_file -h123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF```123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFResults will be put in correspond folder with suffix `_hydrogens` e.g.:  `3_vinardo_dock` and `3_vinardo_dock_hydrogens`123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF#### minimize123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF**Require Openbabel Python binding**123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFminimize the energy of the molecule (only minimize hydrogen, keep other atoms fixed)123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNFResults will be put in correspond folder with suffix `_minimize` e.g: `4_smina_dock` and `4_smina_dock_minimize`123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF123343DJNBFHJBJNKFJNBHDRFBNJKDJUNF